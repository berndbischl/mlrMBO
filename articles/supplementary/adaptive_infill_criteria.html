<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adaptive Infill Criteria â€¢ mlrMBO</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<link href="../../extra.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Adaptive Infill Criteria">
<meta property="og:description" content="mlrMBO">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org"></a>
        <a class="navbar-brand" href="../../index.html">mlrMBO <small>v1.1.5-9000</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../articles/mlrMBO.html">
    <span class="fas fa-bolt"></span>
     
    Quickstart
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-text-o"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/supplementary/mixed_space_optimization.html">Mixed Space Optimization</a>
    </li>
    <li>
      <a href="../../articles/supplementary/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/supplementary/noisy_optimization.html">Noisy Optimization</a>
    </li>
    <li>
      <a href="../../articles/supplementary/infill_criteria.html">Infill Criteria</a>
    </li>
    <li>
      <a href="../../articles/supplementary/machine_learning_with_mlrmbo.html">Machine learning with mlrMBO</a>
    </li>
    <li>
      <a href="../../articles/supplementary/human_in_the_loop_MBO.html">Human-in-the-loop MBO</a>
    </li>
    <li>
      <a href="../../articles/supplementary/mlrmbo_and_the_command_line.html">mlrMBO and the Command Line</a>
    </li>
    <li>
      <a href="../../articles/supplementary/adaptive_infill_criteria.html">Adaptive Infill Criteria</a>
    </li>
    <li>
      <a href="../../articles/supplementary/warmstart.html">Warm Starting Optimization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlrMBO/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fas fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="adaptive_infill_criteria_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adaptive Infill Criteria</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlrMBO/blob/master/vignettes/supplementary/adaptive_infill_criteria.Rmd"><code>vignettes/supplementary/adaptive_infill_criteria.Rmd</code></a></small>
      <div class="hidden name"><code>adaptive_infill_criteria.Rmd</code></div>

    </div>

    
    
<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>This vignette gives a short example of the usage of the adaptive infill criteria in <code>mlrMBO</code>.</p>
</div>
<div id="adaptive-infill-criteria" class="section level2">
<h2 class="hasAnchor">
<a href="#adaptive-infill-criteria" class="anchor"></a>Adaptive Infill Criteria</h2>
<p>An adaptive infill criterion can change its behaviour based on the progress of the optimization. The progress has to be supplied by the termination criterion. All integrated termination criteria support this feature.</p>
</div>
<div id="exemplary-usage-of-the-adaptive-cb" class="section level2">
<h2 class="hasAnchor">
<a href="#exemplary-usage-of-the-adaptive-cb" class="anchor"></a>Exemplary Usage of the Adaptive CB</h2>
<p>To specify which infill criterion should be used, the <code>MBOControl</code> object has to be extended by calling <code><a href="../../reference/setMBOControlInfill.html">setMBOControlInfill()</a></code>. In addition to the criterion you can also set the parameters of the infill criterion optimization. The criterion itself is created with <code>makeMBOInfillCrit*()</code>. The most common infill criteria are predefined like <code>crit.ei</code> and <code>crit.cb2</code>. See <code><a href="../../reference/makeMBOInfillCrit.html">?MBOInfillCrit</a></code> for details.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctrl</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeMBOControl.html">makeMBOControl</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">ctrl</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setMBOControlTermination.html">setMBOControlTermination</a></span><span class="op">(</span><span class="va">ctrl</span>, iters <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span>
<span class="va">ctrl</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setMBOControlInfill.html">setMBOControlInfill</a></span><span class="op">(</span><span class="va">ctrl</span>, crit <span class="op">=</span> <span class="fu"><a href="../../reference/infillcrits.html">makeMBOInfillCritAdaCB</a></span><span class="op">(</span>cb.lambda.start <span class="op">=</span> <span class="fl">4</span>, cb.lambda.end <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This will lead to an CB infill criterion (<span class="math inline">\(CB(x) = \hat{\mu}(x) \pm \lambda * \hat{s}(x)\)</span>) that will focus on uncertain regions in the beginning (<code>cb.lambda.start = 4</code>) and towards the end will have a stronger focus on areas close to the global minimum of the surrogate (<code>cb.lambda.end = 0.1</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test.fun</span> <span class="op">=</span> <span class="fu">makeSingleObjectiveFunction</span><span class="op">(</span>
 fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,
 par.set <span class="op">=</span> <span class="fu">makeNumericParamSet</span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>, len <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>You can now start the optimization like usual:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../../reference/mbo.html">mbo</a></span><span class="op">(</span><span class="va">test.fun</span>, control <span class="op">=</span> <span class="va">ctrl</span><span class="op">)</span></code></pre></div>
<p>If we look at the OptPath we can see the different progress values and the resulting different values of lambda.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">opt.path</span><span class="op">)</span><span class="op">)</span>
<span class="co">##              x1           x2            y dob eol error.message exec.time</span>
<span class="co">## 13 1.709222e-01 3.315767e-05 2.906045e-06   5  NA          &lt;NA&gt;         0</span>
<span class="co">## 14 1.295025e-01 8.443279e-01 9.588378e-03   6  NA          &lt;NA&gt;         0</span>
<span class="co">## 15 9.034855e-07 3.963116e-01 7.574909e-13   7  NA          &lt;NA&gt;         0</span>
<span class="co">## 16 1.780031e-05 1.426885e-01 1.315285e-10   8  NA          &lt;NA&gt;         0</span>
<span class="co">## 17 7.734453e-02 2.116604e-05 3.798570e-07   9  NA          &lt;NA&gt;         0</span>
<span class="co">## 18 4.974571e-05 8.838412e-01 1.164778e-09  10  NA          &lt;NA&gt;         0</span>
<span class="co">##          adacb error.model train.time    prop.type propose.time         se</span>
<span class="co">## 13 -0.07941553        &lt;NA&gt;      0.062 infill_adacb        0.286 0.05191567</span>
<span class="co">## 14 -0.05742526        &lt;NA&gt;      0.078 infill_adacb        0.308 0.03896669</span>
<span class="co">## 15 -0.03561136        &lt;NA&gt;      0.063 infill_adacb        0.283 0.05122894</span>
<span class="co">## 16 -0.02551353        &lt;NA&gt;      0.062 infill_adacb        0.288 0.02848993</span>
<span class="co">## 17 -0.01810171        &lt;NA&gt;      0.065 infill_adacb        0.292 0.02735144</span>
<span class="co">## 18 -0.01358218        &lt;NA&gt;      0.089 infill_adacb        0.313 0.01770508</span>
<span class="co">##             mean lambda</span>
<span class="co">## 13 -0.0145209435   1.25</span>
<span class="co">## 14 -0.0145618935   1.10</span>
<span class="co">## 15  0.0130561294   0.95</span>
<span class="co">## 16 -0.0027215871   0.80</span>
<span class="co">## 17 -0.0003232685   0.65</span>
<span class="co">## 18 -0.0047296468   0.50</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Jakob Richter, Jakob Bossek, Daniel Horn, Michel Lang, Janek Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
